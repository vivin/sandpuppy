import matplotlib.pyplot as plt
import numpy as np
from scipy.interpolate import make_interp_spline

plt.rcParams["font.family"] = "Times New Roman"

seq_counts = [
    [725, 83, 78, 78, 30, 24, 38, 22, 33, 20, 19, 19, 20, 38, 15, 19, 19, 37, 55, 16, 22, 18, 48, 28, 15, 20, 26, 3, 19,
     11, 8, 35, 10, 16, 5, 22, 16, 14, 22, 7, 23, 8, 10, 15, 9, 14, 8, 5, 6, 5, 4, 10, 4, 1, 6, 6, 6, 9, 6, 0, 2, 6, 3,
     1, 4, 2, 4, 2, 4, 3, 2, 3, 1, 4, 3, 2, 2, 3, 2, 1, 0, 2, 2, 0, 2, 1, 2, 0, 1, 2, 1, 3, 2, 2, 1, 2, 1, 1, 0, 1, 0,
     0, 0, 0, 0, 1, 0, 0, 2, 0],#, 0],
    [801, 26, 35, 23, 36, 55, 93, 89, 76, 80, 83, 66, 61, 68, 58, 64, 57, 49, 49, 39, 54, 44, 42, 35, 33, 32, 37, 28,
     25, 29, 23, 30, 19, 18, 19, 24, 14, 10, 18, 11, 16, 14, 6, 13, 5, 14, 10, 7, 5, 14, 11, 9, 6, 4, 8, 6, 2, 9, 6, 15,
     7, 7, 5, 10, 4, 6, 9, 7, 7, 4, 8, 3, 5, 10, 11, 3, 5, 4, 4, 6, 4, 3, 3, 8, 4, 1, 5, 3, 5, 1, 7, 0, 4, 3, 3, 6, 4,
     6, 1, 1, 2, 0, 0, 3, 1, 1, 0, 1, 1, 0],#, 1],
    [951, 57, 29, 27, 47, 59, 98, 83, 81, 67, 65, 52, 53, 56, 47, 38, 44, 42, 47, 31, 27, 27, 33, 27, 30, 23, 33, 23,
     20, 26, 15, 26, 18, 15, 15, 13, 14, 17, 12, 12, 17, 9, 14, 14, 7, 9, 12, 11, 9, 16, 8, 9, 5, 6, 10, 7, 5, 5, 9, 11,
     10, 7, 6, 8, 7, 3, 8, 6, 3, 3, 7, 4, 3, 5, 4, 5, 5, 2, 5, 4, 6, 5, 1, 6, 4, 6, 5, 3, 1, 3, 4, 2, 6, 1, 3, 4, 2, 2,
     1, 0, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1],#, 1],
    [754, 92, 203, 182, 140, 127, 100, 88, 105, 76, 68, 69, 60, 69, 72, 54, 53, 53, 40, 52, 35, 42, 36, 49, 25, 23, 29,
     32, 26, 30, 31, 23, 16, 27, 15, 24, 14, 5, 17, 11, 12, 17, 12, 14, 11, 9, 12, 6, 9, 7, 7, 11, 5, 7, 10, 7, 2, 4, 3,
     4, 5, 6, 3, 8, 6, 5, 2, 3, 4, 7, 2, 2, 3, 5, 2, 2, 2, 3, 7, 3, 4, 4, 4, 5, 4, 5, 2, 1, 3, 1, 0, 4, 2, 3, 1, 3, 1,
     4, 2, 0, 0, 1, 1, 0, 0, 0, 2, 2, 1, 0],#, 1],
    [1094, 448, 282, 234, 211, 386, 451, 455, 609, 293, 289, 417, 447, 922, 959, 734, 922, 501, 829, 967, 924, 728,
     1623, 1431, 1395, 1094, 1340, 1284, 1903, 1614, 1545, 1757, 1491, 1524, 1229, 1414, 1339, 1329, 1147, 959, 1235,
     875, 1282, 1234, 1368, 1419, 1009, 1398, 1087, 1326, 1339, 1657, 1499, 1523, 1553, 1399, 1392, 1494, 959, 1230,
     1356, 1585, 1365, 1293, 1281, 1213, 1485, 1362, 1236, 1168, 1106, 1119, 1343, 1123, 1336, 1246, 1423, 1372, 1364,
     1290, 1172, 1254, 1144, 1105, 1142, 1364, 1234, 1115, 1034, 1205, 1183, 1287, 1066, 1142, 1057, 1151, 1114, 1136,
     712, 616, 622, 576, 658, 480, 353, 531, 785, 547, 585, 656]#, 388]
]
X_axis = np.arange(0, 110, 1)

step = 10
X_axis_step = np.arange(0, 110, step)

fig = plt.gcf()
fig.set_size_inches(8, 7)

colors = ['darkblue', 'darkgreen', 'olive', 'darkorchid', 'crimson']
labels = ['AFL', 'AFL++', 'AFL++ (LAFIntel)', 'AFL++ (RedQueen)', 'SandPuppy']

for i in range(0, 5):
    summed = np.sum(np.array(seq_counts[i]).reshape(-1, step), axis=1)
    plt.plot(X_axis_step, summed, color=colors[i], label=labels[i], marker='o')

plt.xlabel("Hours", size=20)
plt.ylabel("Unique command sequences found", size=20)
plt.yscale('symlog')
#plt.title('Unique command-sequences with parameter size found over time', size=20)
plt.legend(fontsize=18)
plt.xticks(fontsize=18)
plt.yticks(fontsize=18)

fig.tight_layout()
plt.subplots_adjust(top=1, bottom=0.09, left=0.0965)
plt.savefig("/home/vivin/Projects/sandpuppy-paper/unique_seqs_over_time.png")
